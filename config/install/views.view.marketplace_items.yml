langcode: en
status: true
dependencies:
  module:
    - game_market
id: marketplace_items
label: 'Marketplace Items'
module: views
description: 'Lists all individual items available for sale across all listings.'
tag: ''
base_table: listing_item
base_field: id
core: '11.x'
display:
  default:
    display_plugin: default
    id: default
    display_title: Master
    position: 0
    display_options:
      title: 'All Items for Sale'
      access:
        type: perm
        options:
          perm: 'access content'
      query:
        type: views_query
      pager:
        type: full
        options:
          items_per_page: 25
      style:
        type: table
        options:
          default: name
          columns:
            item_image_link: item_image_link
            name: name
            discord_name: discord_name
            seller: seller
            price: price
            quantity: quantity
            listing_link: listing_link
          info:
            item_image_link:
              sortable: false
            name:
              sortable: true
            discord_name:
              sortable: true
            seller:
              sortable: true
            price:
              sortable: true
            quantity:
              sortable: true
            listing_link:
              sortable: false
      row:
        type: fields
      relationships:
        parent_listing:
          id: parent_listing
          table: listing_item
          field: parent_listing
          relationship: none
          plugin_id: standard
          required: true
        item_ref:
          id: item_ref
          table: listing_item
          field: item_ref
          relationship: none
          plugin_id: standard
          required: true
      fields:
        item_image_link:
          id: item_image_link
          table: listing_item
          field: id
          label: 'Image'
          plugin_id: field
          alter:
            rewrite: true
            text: 'View'
            make_link: false
        name:
          id: name
          table: game_item
          field: name
          relationship: item_ref
          label: 'Item'
          plugin_id: field
        discord_name:
          id: discord_name
          table: game_listing
          field: field_discord_name
          relationship: parent_listing
          label: 'Discord Name'
          plugin_id: field
        seller:
          id: seller
          table: game_listing
          field: uid
          relationship: parent_listing
          label: 'Seller'
          plugin_id: field
          settings:
            link_to_entity: true
        price:
          id: price
          table: listing_item
          field: price
          label: 'Price (gold)'
          plugin_id: field
        quantity:
          id: quantity
          table: listing_item
          field: quantity
          label: 'Quantity'
          plugin_id: field
        listing_link:
          id: listing_link
          table: listing_item
          field: id
          label: 'View Listing'
          plugin_id: custom
          alter:
            make_link: true
            path: '/marketplace/[parent_listing]'
            text: 'View Listing'
            absolute: false
      sort:
        name:
          id: name
          table: game_item
          field: name
          relationship: item_ref
          order: ASC
        price:
          id: price
          table: listing_item
          field: price
          order: ASC
      css_class: 'marketplace-items-view'
  page_1:
    display_plugin: page
    id: page_1
    display_title: 'All Items Page'
    position: 1
    display_options:
      path: 'marketplace/items'
      menu:
        type: normal
        title: 'All Items'
        description: 'View all items for sale across listings.'
        menu_name: main
      access:
        type: perm
        options:
          perm: 'access content'
